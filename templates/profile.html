{% extends "base.html" %}
{% block title %}Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ú©Ø§Ø±Ø¨Ø±{% endblock %}
{% block content %}

<div class="profile-container">

    <div class="profile-card">
        <div class="avatar">
            <img src="https://cdn-icons-png.flaticon.com/512/1946/1946429.png" alt="User Avatar">
        </div>
        <h2 class="username">{{ user.username }}</h2>
        <p class="id">Ú©Ø¯ Ù…Ù„ÛŒ: {{ user.national_id }}</p>
        <p class="birth">ØªØ§Ø±ÛŒØ® ØªÙˆÙ„Ø¯: {{ user.birthday.strftime('%Y-%m-%d') }}</p>
        <p class="created">Ø¹Ø¶Ùˆ Ø´Ø¯Ù‡ Ø¯Ø±: {{ user.created_at.strftime('%Y-%m-%d') }}</p>
    </div>

    <div class="profile-edit">
        <form method="post" id="profileForm">
            <h3>ÙˆÛŒØ±Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±ÛŒ</h3>

            <label>ğŸ“ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†:</label>
            <input type="text" name="phone" id="phone" value="{{ user.phone or '' }}" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ Ø¬Ø¯ÛŒØ¯">
            <small id="phoneError" style="color:red; display:none;"></small>

            <hr>

            <h3>ğŸ”’ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</h3>
            <label>Ø±Ù…Ø² ÙØ¹Ù„ÛŒ:</label>
            <input type="password" name="current_password" placeholder="Ø±Ù…Ø² ÙØ¹Ù„ÛŒ">

            <label>Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯:</label>
            <input type="password" name="new_password" id="password" placeholder="Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯">
            <div id="strength-message" class="strength"></div>
            <label>ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯:</label>
            <input type="password" name="confirm_password" placeholder="ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¬Ø¯ÛŒØ¯">

            <div class="buttons">
                <button type="submit" class="btn save">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª</button>
                <a href="{{ url_for('todo_list') }}" class="btn back">ğŸ”™ Ø¨Ø§Ø²Ú¯Ø´Øª</a>
            </div>
        </form>
    </div>

</div>


<script>
    const passwordInput = document.getElementById('password');
    const strengthMsg = document.getElementById('strength-message');

passwordInput?.addEventListener('input', () => {
  const value = passwordInput.value;
  let strength = 0;

  if (value.length >= 8) strength++;              // Ø·ÙˆÙ„ Ú©Ø§ÙÛŒ
  if (/[A-Z]/.test(value)) strength++;            // Ø­Ø±ÙˆÙ Ø¨Ø²Ø±Ú¯
  if (/[a-z]/.test(value)) strength++;            // Ø­Ø±ÙˆÙ Ú©ÙˆÚ†Ú©
  if (/[0-9]/.test(value)) strength++;            // Ø¹Ø¯Ø¯
  if (/[^A-Za-z0-9]/.test(value)) strength++;     // Ú©Ø§Ø±Ø§Ú©ØªØ± Ø®Ø§Øµ

  if (value.length === 0) {
    strengthMsg.textContent = '';
    strengthMsg.style.color = '';
  } else if (strength <= 2) {
    strengthMsg.textContent = 'Ø±Ù…Ø² Ø¶Ø¹ÛŒÙ ğŸ˜•';
    strengthMsg.style.color = 'red';
  } else if (strength === 3 || strength === 4) {
    strengthMsg.textContent = 'Ø±Ù…Ø² Ù…ØªÙˆØ³Ø· ğŸ™‚';
    strengthMsg.style.color = 'orange';
  } else {
    strengthMsg.textContent = 'Ø±Ù…Ø² Ù‚ÙˆÛŒ ğŸ’ª';
    strengthMsg.style.color = 'green';
  }
});
</script>


{% endblock %}